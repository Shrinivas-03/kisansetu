<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kisansetu - Customer Dashboard</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        /* Add your custom styles here */
        .navbar {
            background-color: #1a73e8;
            padding: 1rem;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .navbar h1 {
            color: white;
            margin: 0;
            font-size: 1.5rem;
        }
        .nav-links {
            display: flex;
            gap: 20px;
        }
        .nav-links a {
            color: white;
            text-decoration: none;
            padding: 5px 10px;
            border-radius: 4px;
            transition: background-color 0.3s;
        }
        .nav-links a:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        .dashboard-container {
            padding: 80px 20px 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        .search-section, .orders-section, .wishlist-section, 
        .reviews-section, .notifications-section, .payment-section {
            margin-bottom: 30px;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            background: white;
        }
        .search-filters {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
        }
        .product-card {
            border: 1px solid #ddd;
            padding: 10px;
            border-radius: 8px;
            position: relative;
        }
        .order-track {
            display: flex;
            align-items: center;
            gap: 20px;
            margin: 20px 0;
        }
        .track-step {
            flex: 1;
            text-align: center;
        }
        .section-hidden {
            display: none !important;
        }
        .review-card {
            border: 1px solid #ddd;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 10px;
            max-height: 2.5cm;
            overflow-y: auto;
            font-size: 0.9rem;
        }
        .review-card h4 {
            margin: 0 0 5px 0;
            font-size: 1rem;
        }
        .review-card p {
            margin: 5px 0;
            line-height: 1.2;
        }
        .review-card small {
            color: #666;
            font-size: 0.8rem;
        }
        .reviews-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            padding: 10px;
        }
        .loading {
            opacity: 0.5;
            pointer-events: none;
        }
        .sort-controls {
            margin: 10px 0;
            display: flex;
            gap: 10px;
            align-items: center;
        }
        .wishlist-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: white;
            border: none;
            border-radius: 50%;
            padding: 5px;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .wishlist-btn.active {
            color: red;
        }
        .cart-icon {
            position: relative;
            margin-left: 20px;
        }
        .cart-count {
            position: absolute;
            top: -8px;
            right: -8px;
            background: red;
            color: white;
            border-radius: 50%;
            padding: 2px 6px;
            font-size: 12px;
        }
    </style>
</head>
<body style="background-color: #f0f2f5; margin: 0; font-family: Arial, sans-serif;">
    <!-- Update Navigation Bar -->
    <div class="navbar">
        <h1>Kisansetu</h1>
        <div class="nav-links">
            <a href="#" id="nav-orders">My Orders</a>
            <a href="#wishlist">Wishlist</a>
            <a href="#profile">Profile</a>
            <div class="cart-icon">
                <i class="fas fa-shopping-cart"></i>
                <span class="cart-count">0</span>
            </div>
            <a href="login.html">Logout</a>
        </div>
    </div>

    <div class="dashboard-container">
        <!-- Search & Filters Section -->
        <div class="search-section">
            <h2>Search Products</h2>
            <div class="search-filters">
                <input type="text" id="searchInput" placeholder="Search products..." 
                    style="padding: 8px; flex: 1;">
                <select id="categoryFilter" style="padding: 8px;">
                    <option value="all">Category</option>
                    <option value="vegetables">Vegetables</option>
                    <option value="fruits">Fruits</option>
                    <option value="grains">Grains</option>
                    <option value="dairy">Dairy</option>
                    <option value="pulses">Pulses</option>
                    <option value="spices">Spices</option>
                </select>
                <select id="priceFilter" style="padding: 8px;">
                    <option value="all">Price Range</option>
                    <option value="0-100">₹0 - ₹100</option>
                    <option value="101-500">₹101 - ₹500</option>
                    <option value="501-up">₹501+</option>
                </select>
                <select id="ratingFilter" style="padding: 8px;">
                    <option value="all">Rating</option>
                    <option value="4">4+ Stars</option>
                    <option value="3">3+ Stars</option>
                    <option value="2">2+ Stars</option>
                </select>
            </div>
            <div class="sort-controls">
                <label>Sort by:</label>
                <select id="sortBy" style="padding: 8px;">
                    <option value="price-asc">Price: Low to High</option>
                    <option value="price-desc">Price: High to Low</option>
                    <option value="rating-desc">Rating: High to Low</option>
                    <option value="name-asc">Name: A to Z</option>
                </select>
            </div>
        </div>

        <!-- Modified Orders Section -->
        <div id="orders" class="orders-section section-hidden">
            <h2>My Orders</h2>
            <div id="ordersList" style="display: flex; flex-direction: column; gap: 10px;"></div>
        </div>

        <!-- Wishlist Section -->
        <div id="wishlist" class="wishlist-section">
            <h2>My Wishlist</h2>
            <div id="wishlistGrid" class="product-grid"></div>
        </div>

        <!-- Reviews Section -->
        <div id="reviews" class="reviews-section">
            <h2>My Reviews</h2>
            <div id="reviewsList" class="reviews-grid"></div>
        </div>

        <!-- Notifications Section -->
        <div class="notifications-section">
            <h2>Notifications</h2>
            <div style="display: flex; flex-direction: column; gap: 10px;">
                <div style="padding: 10px; background: #e8f0fe; border-radius: 4px;">
                    <strong>Order #12345 Update</strong>
                    <p>Your order is out for delivery!</p>
                    <small>2 hours ago</small>
                </div>
                <div style="padding: 10px; background: #e8f0fe; border-radius: 4px;">
                    <strong>Special Offer!</strong>
                    <p>20% off on all vegetables today!</p>
                    <small>1 day ago</small>
                </div>
            </div>
            <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                <input type="checkbox" id="email-notif">
                <label for="email-notif">Email Notifications</label>
                <input type="checkbox" id="sms-notif">
                <label for="sms-notif">SMS Notifications</label>
            </div>
        </div>

        <!-- Payment Section -->
        <div class="payment-section">
            <h2>Payment Methods</h2>
            <div style="display: flex; gap: 20px; margin-top: 10px;">
                <button style="padding: 10px; border: 1px solid #ddd; background: white;">
                    <i class="fab fa-cc-visa"></i> Credit Card
                </button>
                <button style="padding: 10px; border: 1px solid #ddd; background: white;">
                    <i class="fab fa-paypal"></i> PayPal
                </button>
                <button style="padding: 10px; border: 1px solid #ddd; background: white;">
                    <i class="fas fa-mobile-alt"></i> UPI
                </button>
                <button style="padding: 10px; border: 1px solid #ddd; background: white;">
                    <i class="fab fa-bitcoin"></i> Crypto
                </button>
            </div>
        </div>
    </div>

    <script>
        // Add this section management code at the start of your script
        const cart = {
            items: [],
            add(product, price) {
                this.items.push({ product, price });
                this.updateCount();
                this.saveToLocal();
            },
            remove(product) {
                this.items = this.items.filter(item => item.product !== product);
                this.updateCount();
                this.saveToLocal();
            },
            updateCount() {
                document.querySelector('.cart-count').textContent = this.items.length;
            },
            saveToLocal() {
                localStorage.setItem('cart', JSON.stringify(this.items));
            },
            loadFromLocal() {
                const saved = localStorage.getItem('cart');
                if (saved) {
                    this.items = JSON.parse(saved);
                    this.updateCount();
                }
            }
        };

        function initializeSectionVisibility() {
            const ordersSection = document.getElementById('orders');
            const navOrders = document.getElementById('nav-orders');

            navOrders.addEventListener('click', function(e) {
                e.preventDefault();
                ordersSection.classList.toggle('section-hidden');
                
                // Scroll into view if showing orders
                if (!ordersSection.classList.contains('section-hidden')) {
                    ordersSection.scrollIntoView({ behavior: 'smooth' });
                }
            });
        }

        // Helper functions
        function getRandomProduct() {
            const productsByCategory = {
                vegetables: [
                    { name: 'Fresh Tomatoes', priceRange: [30, 60] },
                    { name: 'Red Onions', priceRange: [20, 40] },
                    { name: 'Green Peas', priceRange: [40, 80] },
                    { name: 'Baby Potatoes', priceRange: [30, 50] },
                    { name: 'Cauliflower', priceRange: [25, 45] },
                    { name: 'Broccoli', priceRange: [60, 90] },
                    { name: 'Bell Peppers', priceRange: [80, 120] },
                    { name: 'Carrots', priceRange: [30, 50] },
                    { name: 'French Beans', priceRange: [40, 60] },
                    { name: 'Cabbage', priceRange: [20, 40] },
                ],
                fruits: [
                    { name: 'Organic Apples', priceRange: [150, 200] },
                    { name: 'Sweet Oranges', priceRange: [80, 120] },
                    { name: 'Ripe Bananas', priceRange: [40, 60] },
                    { name: 'Green Grapes', priceRange: [100, 150] },
                    { name: 'Alphonso Mangoes', priceRange: [200, 400] },
                    { name: 'Fresh Strawberries', priceRange: [180, 250] },
                    { name: 'Pomegranate', priceRange: [120, 180] },
                    { name: 'Sweet Pineapple', priceRange: [60, 90] },
                    { name: 'Tender Coconut', priceRange: [40, 60] },
                    { name: 'Papaya', priceRange: [50, 80] },
                ],
                grains: [
                    { name: 'Basmati Rice', priceRange: [80, 120] },
                    { name: 'Whole Wheat', priceRange: [40, 60] },
                    { name: 'Brown Rice', priceRange: [90, 140] },
                    { name: 'Quinoa', priceRange: [200, 300] },
                    { name: 'Steel Cut Oats', priceRange: [150, 200] },
                    { name: 'Organic Millets', priceRange: [70, 100] },
                    { name: 'Barley', priceRange: [60, 90] },
                    { name: 'Corn Flour', priceRange: [50, 80] },
                    { name: 'Semolina', priceRange: [40, 70] },
                    { name: 'Buckwheat', priceRange: [180, 240] },
                ],
            };

            const category = Object.keys(productsByCategory)[Math.floor(Math.random() * Object.keys(productsByCategory).length)];
            const products = productsByCategory[category];
            const product = products[Math.floor(Math.random() * products.length)];
            return {
                name: product.name,
                category: category,
                price: Math.floor(Math.random() * (product.priceRange[1] - product.priceRange[0]) + product.priceRange[0])
            };
        }

        function getRandomPrice() {
            const product = getRandomProduct();
            return product.price;
        }

        function getRandomStars() {
            return '⭐'.repeat(Math.floor(Math.random() * 2 + 3));
        }

        function getRandomDate() {
            const start = new Date(2024, 0, 1);
            const end = new Date();
            return new Date(start.getTime() + Math.random() * (end.getTime() - start.getTime()))
                .toLocaleDateString('en-IN');
        }

        function getRandomStatus() {
            const statuses = [
                { text: 'Delivered', color: '#34a853' },
                { text: 'In Transit', color: '#1a73e8' },
                { text: 'Processing', color: '#fbbc04' },
                { text: 'Cancelled', color: '#ea4335' }
            ];
            return statuses[Math.floor(Math.random() * statuses.length)];
        }

        function getRandomOrderItems() {
            const qty = Math.floor(Math.random() * 3 + 1);
            return `${qty} kg ${getRandomProduct().name}, ${Math.floor(Math.random() * 2 + 1)} kg ${getRandomProduct().name}`;
        }

        function getRandomReview() {
            const reviews = [
                'Excellent quality! Will buy again.',
                'Good product but slightly expensive.',
                'Fresh and well packed.',
                'Delivery was quick and product was fresh.',
                'Average quality but good service.',
                'Very satisfied with the purchase.',
                'Best price in the market!',
                'Good quality product.',
                'Will recommend to others.',
                'Nice packaging and delivery.'
            ];
            return reviews[Math.floor(Math.random() * reviews.length)];
        }

        function isInPriceRange(price, range) {
            if (range === 'all') return true;
            
            const [min, max] = range.split('-');
            if (max === 'up') {
                return price >= parseInt(min);
            }
            return price >= parseInt(min) && price <= parseInt(max);
        }

        function filterProducts() {
            const grid = document.getElementById('wishlistGrid');
            grid.classList.add('loading');
            
            setTimeout(() => {
                const priceRange = document.getElementById('priceFilter').value;
                const searchText = document.getElementById('searchInput').value.toLowerCase();
                const categoryValue = document.getElementById('categoryFilter').value;
                const products = document.querySelectorAll('.product-card');

                products.forEach(product => {
                    const price = parseInt(product.querySelector('p').textContent.replace(/[^0-9]/g, ''));
                    const title = product.querySelector('h3').textContent.toLowerCase();
                    const category = product.dataset.category;

                    const matchesPrice = isInPriceRange(price, priceRange);
                    const matchesSearch = searchText === '' || title.includes(searchText);
                    const matchesCategory = categoryValue === 'all' || category === categoryValue;
                    
                    if (matchesPrice && matchesSearch && matchesCategory) {
                        product.style.display = '';
                    } else {
                        product.style.display = 'none';
                    }
                });
                grid.classList.remove('loading');
            }, 300);
        }

        function sortProducts() {
            const grid = document.getElementById('wishlistGrid');
            const products = Array.from(grid.children);
            const sortBy = document.getElementById('sortBy').value;

            products.sort((a, b) => {
                switch(sortBy) {
                    case 'price-asc':
                        return getPrice(a) - getPrice(b);
                    case 'price-desc':
                        return getPrice(b) - getPrice(a);
                    case 'rating-desc':
                        return getRating(b) - getRating(a);
                    case 'name-asc':
                        return getName(a).localeCompare(getName(b));
                }
            });

            grid.innerHTML = '';
            products.forEach(product => grid.appendChild(product));
        }

        function getPrice(element) {
            return parseInt(element.querySelector('p').textContent.replace(/[^0-9]/g, ''));
        }

        function getRating(element) {
            return parseFloat(element.querySelector('span:last-child').textContent.replace(/[()]/g, ''));
        }

        function getName(element) {
            return element.querySelector('h3').textContent;
        }

        function getProductImageUrl(category, productName) {
            const imageUrls = {
                vegetables: {
                    'Fresh Tomatoes': 'n:/kisansetu/images/vegetables/n.jpg',
                    'Red Onions': 'n:/kisansetu/images/vegetables/n.jpg',
                    'Green Peas': 'n:/kisansetu/images/vegetables/n.jpg',
                    'Baby Potatoes': 'n:/kisansetu/images/vegetables/n.jpg',
                    'Cauliflower': 'n:/kisansetu/images/vegetables/n.jpg',
                    'Broccoli': 'n:/kisansetu/images/vegetables/n.jpg',
                    'Bell Peppers': 'n:/kisansetu/images/vegetables/n.jpg',
                    'Carrots': 'n:/kisansetu/images/vegetables/n.jpg',
                    'French Beans': 'n:/kisansetu/images/vegetables/n.jpg',
                    'Cabbage': 'n:/kisansetu/images/vegetables/n.jpg'
                },
                fruits: {
                    'Organic Apples': 'n:/kisansetu/images/fruits/n.jpg',
                    'Sweet Oranges': 'n:/kisansetu/images/fruits/n.jpg',
                    'Ripe Bananas': 'n:/kisansetu/images/fruits/n.jpg',
                    'Green Grapes': 'n:/kisansetu/images/fruits/n.jpg',
                    'Alphonso Mangoes': 'n:/kisansetu/images/fruits/n.jpg',
                    'Fresh Strawberries': 'n:/kisansetu/images/fruits/n.jpg',
                    'Pomegranate': 'n:/kisansetu/images/fruits/n.jpg',
                    'Sweet Pineapple': 'n:/kisansetu/images/fruits/n.jpg',
                    'Tender Coconut': 'n:/kisansetu/images/fruits/n.jpg',
                    'Papaya': 'n:/kisansetu/images/fruits/n.jpg'
                },
                grains: {
                    'Basmati Rice': 'n:/kisansetu/images/grains/n.jpg',
                    'Whole Wheat': 'n:/kisansetu/images/grains/n.jpg',
                    'Brown Rice': 'n:/kisansetu/images/grains/n.jpg',
                    'Quinoa': 'n:/kisansetu/images/grains/n.jpg',
                    'Steel Cut Oats': 'n:/kisansetu/images/grains/n.jpg',
                    'Organic Millets': 'n:/kisansetu/images/grains/n.jpg',
                    'Barley': 'n:/kisansetu/images/grains/n.jpg',
                    'Corn Flour': 'n:/kisansetu/images/grains/n.jpg',
                    'Semolina': 'n:/kisansetu/images/grains/n.jpg',
                    'Buckwheat': 'n:/kisansetu/images/grains/n.jpg'
                }
            };

            return imageUrls[category]?.[productName] || 'n:/kisansetu/images/default.jpg';
        }

        function generateProductCard(product) {
            return `
                <div class="product-card" data-category="${product.category}">
                    <img src="${getProductImageUrl(product.category, product.name)}" 
                         alt="${product.name}" 
                         style="width: 100%; height: 150px; object-fit: cover;"
                         onerror="this.src='n:/kisansetu/images/default.jpg'">
                    <h3>${product.name}</h3>
                    <p>₹${product.price}/kg</p>
                    <div style="display: flex; align-items: center; gap: 5px; margin: 5px 0;">
                        <span>${getRandomStars()}</span>
                        <span>(${(Math.random() * 2 + 3).toFixed(1)})</span>
                    </div>
                    <button onclick="addToCart('${product.name}', ${product.price})" 
                        style="width: 100%; padding: 8px; background: #1a73e8; color: white; border: none; border-radius: 4px;">
                        Add to Cart
                    </button>
                    <button class="wishlist-btn">
                        <i class="far fa-heart"></i>
                    </button>
                </div>
            `;
        }

        document.addEventListener('DOMContentLoaded', function() {
            initializeSectionVisibility();
            cart.loadFromLocal();
            document.getElementById('sortBy').addEventListener('change', sortProducts);
            
            const ordersList = document.getElementById('ordersList');
            const ordersHTML = Array.from({length: 20}, (_, i) => {
                const status = getRandomStatus();
                return `
                    <div style="border: 1px solid #ddd; padding: 15px; border-radius: 8px;">
                        <div style="display: flex; justify-content: space-between;">
                            <div>
                                <strong>Order #${12345 - i}</strong>
                                <p>${getRandomOrderItems()}</p>
                            </div>
                            <div style="text-align: right;">
                                <span style="color: ${status.color};">${status.text}</span>
                                <p>₹${getRandomPrice()}</p>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
            ordersList.innerHTML = ordersHTML;

            const wishlistGrid = document.getElementById('wishlistGrid');
            const products = Array.from({length: 60}, () => getRandomProduct());
            const wishlistHTML = products.map(generateProductCard).join('');
            wishlistGrid.innerHTML = wishlistHTML;

            const reviewsList = document.getElementById('reviewsList');
            const reviewsHTML = Array.from({length: 5}, () => {
                const product = getRandomProduct().name;
                return `
                    <div class="review-card">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <h4>${product}</h4>
                            <div style="font-size: 0.8rem;">${getRandomStars()}</div>
                        </div>
                        <p>${getRandomReview()}</p>
                        <small>Posted on: ${getRandomDate()}</small>
                    </div>
                `;
            }).join('');
            reviewsList.innerHTML = reviewsHTML;

            document.getElementById('priceFilter').addEventListener('change', filterProducts);
            document.getElementById('categoryFilter').addEventListener('change', filterProducts);
            document.getElementById('searchInput').addEventListener('input', filterProducts);
            document.getElementById('ratingFilter').addEventListener('change', filterProducts);

            document.querySelectorAll('.wishlist-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    this.classList.toggle('active');
                    const isWishlisted = this.classList.contains('active');
                    this.innerHTML = isWishlisted ? 
                        '<i class="fas fa-heart"></i>' : 
                        '<i class="far fa-heart"></i>';
                });
            });
        });

        function addToCart(product, price) {
            const btn = event.target;
            btn.disabled = true;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
            
            setTimeout(() => {
                cart.add(product, price);
                btn.innerHTML = '<i class="fas fa-check"></i> Added';
                setTimeout(() => {
                    btn.disabled = false;
                    btn.innerHTML = 'Add to Cart';
                }, 2000);
            }, 500);
        }

        const emailNotif = document.getElementById('email-notif');
        const smsNotif = document.getElementById('sms-notif');

        emailNotif.addEventListener('change', function() {
            console.log('Email notifications:', this.checked);
        });

        smsNotif.addEventListener('change', function() {
            console.log('SMS notifications:', this.checked);
        });

        const searchInput = document.querySelector('input[type="text"]');
        searchInput.addEventListener('input', function() {
            console.log('Searching for:', this.value);
        });
    </script>
</body>
</html>
